abline(h = 0, col = "red")
plot(quad_LOS$fitted.values, quad_LOS$residuals, main = 'Residuals vs Fitted Values', xlab = 'Fitted Values', ylab = 'Residuals', pch = 16)
abline(h = 0, col = "red")
plot(lin_LOS)
plot(lin_LOS, which = 1:2)
plot(lin_LOS, which = 1:2, pch = 16)
plot(lin_LOS$fitted.values, lin_LOS$residuals, main = 'Residuals vs Fitted Values', xlab = 'Fitted Values', ylab = 'Residuals', pch = 16)
abline(h = 0, col = "red")
plot(quad_LOS$fitted.values, quad_LOS$residuals, main = 'Residuals vs Fitted Values', xlab = 'Fitted Values', ylab = 'Residuals', pch = 16)
abline(h = 0, col = "red")
plot(lin_LOS, which = 1:2, pch = 16)
plot(quad_LOS, which = 1:2, pch = 16)
plot(lin_LOS, which = 1:2, pch = 16)
plot(quad_LOS, which = 1:2, pch = 16)
summary(lin_LOS)$adj.r.squared
summary(quad_LOS)$adj.r.squared
summary(lin_LOS)$adj.r.squared
summary(quad_LOS)$adj.r.squared
summary(lin_LOS)
summary(lin_LOS)
summary(quad_LOS)
plot(lin_LOS, which = 1:2, pch = 16)
plot(quad_LOS, which = 1:2, pch = 16)
sepic
senic
senic$school = factor(senic$MedSchool)
senic$school = factor(senic$MedSchool)
model_interaction = lm(LengthOfStay ~ InfectionRisk * school + Age + logNumberofBeds + Region, data = senic)
interaction = lm(LengthOfStay ~ InfectionRisk * school + Age + logNumberofBeds + Region, data = senic)
no_interaction = lm(LengthOfStay ~ InfectionRisk + school + Age + log(NumberBeds) + Region, data = senic)
interaction = lm(LengthOfStay ~ InfectionRisk * school + Age + log(NumberBeds) + Region, data = senic)
no_interaction = lm(LengthOfStay ~ InfectionRisk + school + Age + log(NumberBeds) + Region, data = senic)
senic
lm(LengthOfStay ~ InfectionRisk + school + Age + log(NumberBeds) + Region, data = senic)
anova(interaction, no_interaction)
confint(interaction)
interaction
confint(interaction)
anova(interaction, no_interaction)
anova(no_interaction, interaction)
anova(no_interaction, interaction)
library(MASS)
library(MASS)
help(birthwt)
birthwt
birthwt$race = as.factor(birthwt$race)
birthwt$ptl = as.factor(birthwt$ptl)
birthwt$ftv = as.factor(birthwt$ftv)
birthwt
?birthwt
birthwt
pairs(bwt ~ age + lwt + race + smoke + ptl + ht + ui + ftv)
pairs(bwt ~ age + lwt + race + smoke + ptl + ht + ui + ftv, data = birthwt)
pairs(bwt ~ age + lwt + race + smoke + ptl + ht + ui + ftv, data = birthwt, pch=16, cex=0.5,col=2))
pairs(bwt ~ age + lwt + race + smoke + ptl + ht + ui + ftv, data = birthwt, pch=16, cex=0.5,col=2)
lm_bwt = lm(bwt ~ age + lwt + race + smoke + ptl + ht + ui + ftv, data = birthwt)
summarize(lm_bwt)
summarise(lm_bwt)
summary(lm_bwt)
lm_bwt
summary(lm_bwt)
lm_bwt
birthwt
plot(birthwt$InfectionRisk, birthwt$residuals, main = "Residuals vs Mother's Age", xlab = "Age", ylab = "Residuals", pch=16)
plot(birthwt$InfectionRisk, birthwt$residuals, main = "Residuals vs Mother's Age", xlab = "Age", ylab = "Residuals", pch=16)
plot(birthwt$InfectionRisk, lm_bwt$residuals, main = "Residuals vs Mother's Age", xlab = "Age", ylab = "Residuals", pch=16)
plot(birthwt$age, lm_bwt$residuals, main = "Residuals vs Mother's Age", xlab = "Age", ylab = "Residuals", pch=16)
plot(birthwt$age, lm_bwt$residuals, main = "Residuals vs Mother's Age", xlab = "Age", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
birthwt
plot(birthwt$race, lm_bwt$residuals, main = "Residuals vs Race", xlab = "Race", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
birthwt
plot(birthwt$ptl, lm_bwt$residuals, main = "Residuals vs Number of Previous Premature Labors", xlab = "Num Premature Labors", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
birthwt
plot(birthwt$age, lm_bwt$residuals, main = "Residuals vs Mother's Age", xlab = "Age", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
plot(birthwt$lwt, lm_bwt$residuals, main = "Residuals vs Mother's Weight", xlab = "Weight", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
plot(birthwt$race, lm_bwt$residuals, main = "Residuals vs Race", xlab = "Race", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
plot(birthwt$smoke, lm_bwt$residuals, main = "Residuals vs Smoking Status", xlab = "Smoke", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
plot(birthwt$ptl, lm_bwt$residuals, main = "Residuals vs Number of Previous Premature Labors", xlab = "Num Premature Labors", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
plot(birthwt$ht, lm_bwt$residuals, main = "Residuals vs History of Hypertension", xlab = "Hypertension", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
plot(birthwt$ui, lm_bwt$residuals, main = "Residuals vs Presence of Uterine Irritability", xlab = "Uterine Irritability", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
plot(birthwt$ftv, lm_bwt$residuals, main = "Residuals vs Number of Physician Visits during First Trimester", xlab = "Num Visits", ylab = "Residuals", pch=16)
abline(h = 0, col = "red")
Homer = read.table("Homer.txt",header=TRUE)
Homer
Homer
pairs(y ~ x1 + x2 + x3 + x4, data = Homer, pch=16, cex=0.5,col=2)
lm_homer = lm(y ~ x1 + x2 + x3 + x4, data = Homer)
summary(lm_homer)
plot(lm_homer$fitted.values, lm_homer$residuals, main = 'Residuals vs Fitted Values', xlab = 'Fitted Values', ylab = 'Residuals', pch = 16)
abline(h = 0, col = "red")
plot(lm_homer$fitted.values, lm_homer$residuals, main = 'Residuals vs Fitted Values', xlab = 'Fitted Values', ylab = 'Residuals', pch = 16, cex = 0.5)
abline(h = 0, col = "red")
plot(lm_homer$fitted.values, lm_homer$residuals, main = 'Residuals vs Fitted Values', xlab = 'Fitted Values', ylab = 'Residuals', pch = 16, cex = 0.3)
abline(h = 0, col = "red")
plot(lm_homer$fitted.values, lm_homer$residuals, main = 'Residuals vs Fitted Values', xlab = 'Fitted Values', ylab = 'Residuals', pch = 16, cex = 0.4)
abline(h = 0, col = "red")
update.packages(ask = FALSE)
update.packages(ask = FALSE)
shiny::runApp('Documents/SDS 375/updateUI')
show(x)
setClass(
Class = "Car",
slots = c(
name = "character",
year = "character",
color = "character",
price = "character"
),
setGeneric("value",
function(x, ...) {
standardGeneric("value")
}),
setMethod("value", "Car",
function(object) {
cat(object@price, "\n")
})
)
setClass(
Class = "Car",
slots = c(
name = "character",
year = "character",
color = "character",
price = "character"
)
)
setGeneric(
"value",
function(x, ...) {
standardGeneric("value")
}
)
setMethod(
"value",
"Car",
function(x) {
cat(x@price, "\n")
}
)
x <- new("Car",
name = "Honda Accord",
year = "2017",
color = "gray",
price = "40000")
show(x)
setClass(
Class = "Car",
slots = c(
name = "character",
year = "character",
color = "character"
)
)
setGeneric(
"value",
function(x, ...) {
standardGeneric("value")
}
)
setMethod(
"value",
"Car",
function(x) {
price = x@year * 15
cat(price, "\n")
}
)
x <- new("Car",
name = "Honda Accord",
year = "2017",
color = "gray",
price = "40000")
setClass(
Class = "Car",
slots = c(
name = "character",
year = "integer",
color = "character"
)
)
setGeneric(
"value",
function(x, ...) {
standardGeneric("value")
}
)
setMethod(
"value",
"Car",
function(x) {
price = x@year * 15
cat(price, "\n")
}
)
x <- new("Car",
name = "Honda Accord",
year = "2017",
color = "gray",
price = "40000")
show(x)
x <- new("Car",
name = "Honda Accord",
year = "2017",
color = "gray",
price = 40000)
show(x)
x <- new("Car",
name = "Honda Accord",
year = "2017",
color = "gray",
price = 40000)
x <- new("Car",
name = "Honda Accord",
year = 2017,
color = "gray")
setClass(
Class = "Car",
slots = c(
name = "character",
year = "numeric",
color = "character"
)
)
setGeneric(
"value",
function(x, ...) {
standardGeneric("value")
}
)
setMethod(
"value",
"Car",
function(x) {
price = x@year * 15
cat(price, "\n")
}
)
x <- new("Car",
name = "Honda Accord",
year = 2017,
color = "gray")
show(x)
y <- new("Car",
name = "Honda Accord",
year = 2017,
color = "gray")
show(y)
setClass(
Class = "Car",
slots = c(
name = "character",
year = "integer",
color = "character",
price = "numeric"
)
)
setGeneric(
"value",
function(x, ...) {
standardGeneric("value")
}
)
setMethod(
"value",
"Car",
function(x) {
price <- x@year * 15
cat(price, "\n")
}
)
x <- new(
"Car",
name = "Honda Accord",
year = 2017,
color = "gray",
price = 40000
)
x <- new(
"Car",
name = "Honda Accord",
year = 2017,
color = "gray",
price = 40000
)
show(x)
# Define the class
setClass(
Class = "Car",
slots = c(
name = "character",
year = "integer",
color = "character"
)
)
# Define a generic
setGeneric(
"value",
function(x, ...) {
standardGeneric("value")
}
)
# Define the method for objects of class "Car"
setMethod(
"value",
"Car",
function(x) {
price <- x@year * 15
cat("Calculated price:", price, "\n")
}
)
# Create an object
x <- new(
"Car",
name = "Honda Accord",
year = 2017L,   # note the L â†’ makes it an integer
color = "gray"
)
# Call the value() method
value(x)
setClass(
Class = "Car",
slots = c(
name = "character",
year = "integer",
color = "character"
)
)
setGeneric(
"value",
function(x, ...) {
standardGeneric("value")
}
)
setMethod(
"value",
"Car",
function(x) {
price <- x@year * 15
cat("Calculated price:", price, "\n")
}
)
x <- new(
"Car",
name = "Honda Accord",
year = 2017L,
color = "gray"
)
value(x)
setClass(
Class = "Car",
slots = c(
name = "character",
year = "integer",
color = "character"
)
)
setGeneric(
"value",
function(x, ...) {
standardGeneric("value")
}
)
setMethod(
"value",
"Car",
function(x) {
price <- x@year * 15
cat(price, "\n")
}
)
x <- new(
"Car",
name = "Honda Accord",
year = 2017L,
color = "gray"
)
value(x)
rbinom(20,2,3/4) # simulate 20 observations from B(2,1/3)
# let us observe the frequencies of 0,1 and 2 from different sample size
table(rbinom(100,2,3/4))/100
#table(rbinom(100,2,3/4))/1000
#table(rbinom(100,2,3/4))/10000
# CDF
pbinom(0,2,1/3) # P(X<0)
#pbinom(1,2,1/3) # P(X<1)
#pbinom(2,2,1/3) # P(X<2)
# PDF
dbinom(0,2,1/3) # calculate P(X=0)
#dbinom(1,2,1/3) # calculate P(X=1)
#dbinom(2,2,1/3) # calculate P(X=2)
# Calculate P(X=27) when X~B(100,0.25)
dbinom(27, size=100, prob=0.25)
#F(x)=P(X<x) pbinom(x,n,p)
pbinom(25,100,0.6)# will give as output P(X<=25)= when X~B(100,0.6)
# Find x such that F(x)= a given value
# P(X<x)=0.5, qbinom(F(x),n,p)
qbinom(0.5,100,0.6) # output x such as F(x)=0.5 when X~B(100,0.6)
var.X <- rbinom(100, 10, 0.3)
hist(var.X)
set.seed(512)
x <- seq(0,100,by=1) # create a sequence from 0 to 100 with step=1
y <- dbinom(x,100,0.6) # Calculate probabilities for X~B(100,0.6) # a vector of values
y
which(y==max(y)) # which is the value of x with the highest probability
rpois(20,5)# simulate 20 values from a Poisson distribution a=5
# Simulation graphs -Histogram
hist(rpois(1000,5),col="red",xlab="Values",ylab="Frequencies", main="Histogram of P(5) for 1000 simulations")
# probability density function for the simulations above
plot(density(rpois(1000,5)),col="blue",lwd=2,main="PDF of P(5) for n=10^3 simulations")
# CDF for P(5), F(x)=P(X<x)
ppois(2,5)# calculates P(X<=2) when X~P(5), including x=2
# Calculates probability of X=x, P(X=x)
dpois(0,5)# P(X=0) when X~P(5)
dpois(0,5)+dpois(1,5) # P(X=0)+P(X=1)=exp(-5)+exp(-5)*5^1
# Finds the value of x for wich we have F(x)=p , qpois(p,a)
qpois(dpois(1,5),5) # finds x such that P(X<x)=F(x)=0.5 when X~P(5)
#1a
dpois(20, 15)
#1b
1 - ppois(20,5)
#1c
ppois(15,15) - ppois(10,15) - dpois(15,15)
#2
hist(rpois(365,16),col="pink",xlab="Values",ylab="Frequencies", main="Histogram of 365 day call")
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
dpois(20, 15)
# x > 20 = 1-(x <1/2/3/4/5/6/7/8/9/10/11/12/13/14)
x <- 0
for (i in 0:20){
dist <- dpois(i, 15)
x <- x + dist
}
answer <- (1 - x)
print(answer)
## for x < 10
ppois(14, 15) - ppois(10, 15)
# lamda = 16
set.seed(123)
hist(rpois(365,16),col="red",xlab="Calls per Day",ylab="Frequencies", main="Histogram of daily call simulations (n=365, lamda = 16)")
install.packages("usethis")
install.pacakges("testthat")
install.packages("testthat")
a <- 10; b <- 35; n1 <- 10000
uni <- runif(n1, min=a, max=b)
hist(uni, breaks=30, probability=TRUE, main="Uniform[10,35] histogram")
curve(dunif(x, min=a, max=b), add=TRUE, lwd=2)
mean(uni); var(uni)
mu <- 50; sd <- 3
norm100 <- rnorm(100, mean=mu, sd=sd)
hist(norm100, breaks=30, probability=TRUE, main="Normal(50,9) n=100")
qqnorm(norm100); qqline(norm100)
mean(norm100); var(norm100); sd(norm100)
lambda <- 1/8
p_a <- exp(-lambda*3) - exp(-lambda*12)
x95 <- -log(0.05)/lambda
p_c <- exp(-lambda*15)
p_a; x95; p_c
install.packages("devtools")
install.packages("roxygen2")
install.packages("usethat")
install.packages("usethis")
install.packages("testthat")
setwd("~/Documents/SDS 375/Homework7")
install.packages("plumber")
library(plumber)
library(lubridate)
train = read.csv("train_dataset.csv.gz")   # your HW4 train data
train
train$specialty = as.factor(train$specialty)
train$address = as.factor(train$address)
train$provider_id = as.factor(train$provider_id)
# Convert datetime vars
train$appt_time = ymd_hms(as.character(train$appt_time))
train$appt_made = ymd(as.character(train$appt_made))
# Create days booked in advance
train$days_booked_in_advance = as.numeric(difftime(train$appt_time, train$appt_made))
# Fit logistic model
model = glm(no_show ~ age + address + specialty + provider_id +
days_booked_in_advance,
data = train,
family = binomial())
model
preprocess_input = function(df) {
df$specialty = factor(df$specialty, levels = levels(train$specialty))
df$address = factor(df$address, levels = levels(train$address))
df$provider_id = factor(df$provider_id, levels = levels(train$provider_id))
df$appt_time = ymd_hms(as.character(df$appt_time))
df$appt_made = ymd(as.character(df$appt_made))
df$days_booked_in_advance = as.numeric(difftime(df$appt_time, df$appt_made))
df
}
#* @post /predict_prob
function(req) {
raw <- req$postBody
df  <- unserialize(raw)
df <- preprocess_input(df)
probs <- predict(model, newdata = df, type = "response")
serialize(probs, NULL)
}
source("HW7_api_server.R")
source("HW7_api_server.R")
